# 测试说明

本目录包含微信读书桌面客户端的集成测试。

## 运行测试

### 运行所有测试
```bash
cd src-tauri
cargo test
```

### 运行特定测试文件
```bash
# 多显示器功能测试
cargo test --test monitor_test

# 核心功能测试
cargo test --test core_test
```

### 运行测试并显示输出
```bash
cargo test -- --nocapture
```

## 测试文件说明

### monitor_test.rs
多显示器功能测试，包括：
- 显示器名称检索
- 坐标转换逻辑（物理像素 ↔ 逻辑点）
- 窗口居中计算
- 菜单项 ID 格式
- 中文字符引号格式化
- 显示器索引比较逻辑

### core_test.rs
核心功能测试，包括：
- 设置序列化/反序列化
- 自动翻页设置结构
- 菜单项 ID 模式
- 版本字符串格式
- 边界检查逻辑
- 显示器索引追踪

## 注意事项

1. **硬件依赖**：某些测试（如实际显示器检测）需要真实的多显示器硬件环境
2. **平台限制**：macOS 特定功能（如 `NSScreen.localizedName`）只在 macOS 上可用
3. **集成测试**：完整的集成测试需要运行 Tauri 应用

## 添加新测试

添加新测试时，请遵循以下准则：

1. **测试一个功能点**：每个测试应该只测试一个具体功能
2. **使用描述性名称**：测试名称应该清楚地描述测试的内容
3. **独立运行**：测试应该可以独立运行，不依赖其他测试的状态
4. **快速执行**：单元测试应该快速执行（毫秒级）

## 测试覆盖范围

当前测试覆盖：
- ✅ 坐标转换逻辑
- ✅ 窗口居中计算
- ✅ 设置序列化
- ✅ 菜单 ID 格式验证

待补充测试：
- ⏳ 实际多显示器环境下的集成测试
- ⏳ Tauri 命令处理器测试
- ⏳ 菜单状态管理测试
- ⏳ 窗口移动端到端测试
